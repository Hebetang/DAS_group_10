---
title: "Group project 2"
author: "Group 10"
output: pdf_document
date: "2023-03-16"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, eval = TRUE, warning = FALSE, message = FALSE, comment = NA)
```


```{r loadpackages,echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
library(tidyverse)
library(moderndive)
library(gapminder)
library(sjPlot)
library(stats)
library(jtools)
library(knitr)
library(GGally)
```

## Step1: Data pre-processing

Our group target is to find Which properties of films influence whether they are rated by IMDB as greater than 7 or not? 

As there are some NA values in this dataset which will influence our result, we first omit those NA value. Then, we use the column rating to create a binary factor. And we omit the invalid column film_id and rating. 

Accoding to dataset, we need to transform the characters type value into factor. Finally, we set the level of response variable to make the graph of the data visualization more understandable.

```{r data, echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
##Read and merge the dataset
#Omit the NA values
film = read.csv("dataset10.csv")%>%
  na.omit()
#Create the binary factor
film$greater_than_7 <- ifelse(film$rating > 7, "yes", "no")
#Select dataset to omit the invalid column(eg.film_id and rating)
film.select = film %>%
  select(year, length, budget, votes, genre, greater_than_7)
#Rename the dataset and transform the chr type value into factor
DataSet = film.select%>%
  mutate_if(is.character, as.factor)
#Set the level of response variable
levels(DataSet$greater_than_7) <- c("IMDB rate less than 7", "IMDB rate greater than 7")
```

## Step2: Illuminating visualizations of the data

The Scatterplot matrix shows that most correlation between explanatory variables are small.

```{r visualization, echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE, out.width='90%',fig.align='center',fig.cap="\\label{fig:Scatterplot matrix 1}Correlation between explanatory variables.",fig.pos='!htbp'}
##Plot to get an initial impression of the data
# Check correlations, distribution and print correlation coefficient 
ggpairs(data= film.select, title="Correlation between explanatory variables",
        ggplot2::aes(color=greater_than_7))
```





There are zero potential outlier in the plot.

```{r visualization1, echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE, out.width='90%',fig.align='center',fig.cap="\\label{fig:box2}The boxplot of year and IMDB rate greater than 7 or not.",fig.pos='!htbp'}
#Plot of year against greater_than_7
ggplot(data = DataSet, aes(x = greater_than_7, y = year, fill = greater_than_7)) +
  geom_boxplot() +
  labs(x = "IMDB rate greater than 7 or not", y = "Year", 
       title = "The boxplot of year and IMDB rate greater than 7 or not") +
  theme(legend.position = "none")
```













There are many potential outliers in the plot.

```{r visualization1.1, echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE, out.width='90%',fig.align='center',fig.cap="\\label{fig:box3}The boxplot of length and IMDB rate greater than 7 or not.",fig.pos='!htbp'} 
#Notice that the factor year seems not to influence rates
#Plot of length against greater_than_7
ggplot(data = DataSet, aes(x = greater_than_7, y = length, fill = greater_than_7)) +
  geom_boxplot() +
  labs(x = "IMDB rate greater than 7 or not", y = "Length",
       title = "The boxplot of length and IMDB rate greater than 7 or not") +
  theme(legend.position = "none")
```














There are eight potential outliers in the plot.

```{r visualization1.2, echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE, out.width='90%',fig.align='center',fig.cap="\\label{fig:box4}The boxplot of budget and IMDB rate greater than 7 or not.",fig.pos='!htbp'}
#Plot of budget against greater_than_7
ggplot(data = DataSet, aes(x = greater_than_7, y = budget, fill = greater_than_7)) +
  geom_boxplot() +
  labs(x = "IMDB rate greater than 7 or not", y = "Budget",
       title = "The boxplot of budget and IMDB rate greater than 7 or not") +
  theme(legend.position = "none")
```











There are all potential outliers in the plot.

```{r visualization1.3, echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE, out.width='90%',fig.align='center',fig.cap="\\label{fig:box5}The boxplot of Votes and IMDB rate greater than 7 or not.",fig.pos='!htbp'}
#Plot of votes against greater_than_7
ggplot(data = DataSet, aes(x = greater_than_7, y = votes, fill = greater_than_7)) +
  geom_boxplot() +
  labs(x = "IMDB rate greater than 7 or not", y = "Votes",
       title = "The boxplot of Votes and IMDB rate greater than 7 or not") +
  theme(legend.position = "none")
```











The histogram shows how many IMDB rates are less than 7 and more than 7 in different movie genre, respectively.

```{r visualization2, echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE, out.width='90%',fig.align='center',fig.cap="\\label{fig:his6}The Histograms of the proportion of movie categories and IMDB rate greater than 7 or not.",fig.pos='!htbp'}
#Plot of genre against greater_than_7
ggplot(data = DataSet, aes(x= greater_than_7,  y = ..prop.., group=genre, fill=genre)) + 
  geom_bar(position="dodge", stat="count") +
  labs(x = "IMDB rate greater than 7 or not", y = "Proportion",
       title = "The Histograms of the proportion of movie categories and IMDB rate greater than 7 or not")
```

## Step3: Modelling

